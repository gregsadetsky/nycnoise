{% load get_gcal_link_from_event %}
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>nyc noise</title>
  <style>
      body {
        background-color: #d4d0c7;
        font-family: "Open Sans", sans-serif;
      }
      #centered_content
      {
        max-width:42em; margin:15px auto;
      }
      p.event {
        margin-bottom: 5px;
      }
      span.smallInfo {
        font-size: 0.9em;
      }
  </style>
  {% include "calendar/style.html" %}
</head>
<body>

<div id='centered_content'>
  <h1 style='margin-bottom:0'>nyc noise</h1>
  <small>~ always incomplete ~</small>

  {% include "calendar/calendar.html" %}

  {% for date, events in all_events.items %}
    <h4>{{ date|date:"D d M Y" }}</h4>
    {% for event in events %}
      {% comment %}
        <h4>{{ event.name }}</h4>
        <p>{{ event.starttime }}</p>
        <p>{{ event.description|safe }}</p>
        <p>{% if event.venue %}{{ event.venue.name }}{% else %}Unknown venue{% endif %}</p>
      {% endcomment %}

      <p class='event'>
        {% comment %}
          original nyc noise format:
          ðŸ“¶ â€¢ 8pm: youbet, Peaer, Jachary @ purgatory (21+), 675 central ave, bushwick, bklyn // MAP
        {% endcomment %}

        {{ event.starttime|date:"gA" }}:

        {% if event.hyperlink %}
          <a href="{{ event.hyperlink }}" target="_blank" style='font-weight:bold'>
            {{ event.name }}
          </a>
        {% else %}
          {{ event.name }}
        {% endif %}

        {% if event.venue %}
          @

          {% if event.venue.age_policy and event.venue.neighborhood_and_borough %}
            {{ event.venue.name }} ({{ event.venue.age_policy }}), {{ event.venue.neighborhood_and_borough }}
          {% elif event.venue.age_policy %}
            {{ event.venue.name }} ({{ event.venue.age_policy }})
          {% elif event.venue.neighborhood_and_borough %}
            {{ event.venue.name }}, {{ event.venue.neighborhood_and_borough }}
          {% else %}
            {{ event.venue.name }}
          {% endif %}

          {% if event.venue.accessibility_emoji or event.venue.accessibility_notes or event.venue.accessibility_link %}
            <span class='smallInfo'>
            //
              {% if event.venue.accessibility_link %}<a href="{{ event.venue.accessibility_link }}" target="_blank">ACCESS</a>{% else %}ACCESS{% endif %}:
              {% if event.venue.accessibility_emoji %}
                {{ event.venue.accessibility_emoji }}
              {% endif %}
              {% if event.venue.accessibility_notes %}
                {{ event.venue.accessibility_notes }}
              {% endif %}
          {% endif %}

          //
          <a href="{{ event.venue.google_maps_link }}" target="_blank" class='smallInfo'>MAP</a>
          //
          <a href="{% url 'event_ics_download' event.id %}">Add to iCal</a>
          //
          <a href={% get_gcal_link_from_event event %}>add to google calendar</a>
        {% else %}
          Unknown venue
        {% endif %}
      </p>
    {% endfor %}
  {% endfor %}
</div>

</body>
</html>
